(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      5034,        148]
NotebookOptionsPosition[      4643,        130]
NotebookOutlinePosition[      4985,        145]
CellTagsIndexPosition[      4942,        142]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"T_", ",", "up_", ",", "down_", ",", "x_", ",", "z_"}], "]"}], " ",
   ":=", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "presumes", " ", "x", " ", "and", " ", "z", " ", "are", " ", "the", " ", 
    "same", " ", "length"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "l", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"l", " ", "=", " ", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Sum", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"z", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"x", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
         ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "l"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "l"}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6327077707030325`*^9, 3.6327078158934746`*^9}, {
  3.632708078446216*^9, 3.632708220603625*^9}, {3.63270829439646*^9, 
  3.6327083005651474`*^9}, {3.63270833220702*^9, 3.6327084074663105`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"v_", ",", "x_", ",", "z_", ",", "i_"}], "]"}], ":=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"z", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"x", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], " ", 
      RowBox[{"v", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6327085741378193`*^9, 3.632708689653346*^9}, {
   3.6327090205220923`*^9, 3.632709077516234*^9}, {3.6327094491128845`*^9, 
   3.632709458262188*^9}, {3.632709565943157*^9, 3.63270958734657*^9}, {
   3.6327096529393682`*^9, 3.6327096662220297`*^9}, 3.632709911302618*^9, {
   3.632709960645653*^9, 3.632709971830023*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transform", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"vx", ",", "vy", ",", "vz"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"x", "^", "2"}], "+", 
       RowBox[{"y", "^", "2"}], "+", 
       RowBox[{"z", "^", "2"}]}], "]"}], ",", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"z", "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}], "+", 
         RowBox[{"z", "^", "2"}]}], "]"}]}], "]"}], ",", 
     RowBox[{"ArcTan", "[", 
      RowBox[{"y", "/", "x"}], "]"}]}], "}"}], ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.6327086921988316`*^9, 3.6327087104451036`*^9}, {
  3.632708746004774*^9, 3.632708758924759*^9}, {3.6327088290997415`*^9, 
  3.6327088999837165`*^9}, {3.632708932351844*^9, 3.632708964292858*^9}, {
  3.6327091555604467`*^9, 3.6327091584126935`*^9}, {3.6327092618442807`*^9, 
  3.6327093514508815`*^9}, {3.6327095005480294`*^9, 3.6327095048364315`*^9}, {
  3.632709670785322*^9, 3.632709671009472*^9}, {3.632710062515853*^9, 
  3.632710070040335*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"vx", " ", "x"}], "+", 
   RowBox[{"vy", " ", "y"}], "+", 
   RowBox[{"vz", " ", "z"}]}], 
  SqrtBox[
   RowBox[{
    SuperscriptBox["x", "2"], "+", 
    SuperscriptBox["y", "2"], "+", 
    SuperscriptBox["z", "2"]}]]]], "Output",
 CellChangeTimes->{
  3.6327095055482388`*^9, 3.632709589765362*^9, {3.6327096719198804`*^9, 
   3.6327096777269645`*^9}, 3.6327099148406305`*^9, {3.6327099659338636`*^9, 
   3.632709977167498*^9}, {3.632710057497999*^9, 3.6327100702903185`*^9}}]
}, Open  ]]
},
WindowSize->{1904, 943},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (October 6, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 1366, 33, 212, "Input"],
Cell[1926, 55, 943, 23, 31, "Input"],
Cell[CellGroupData[{
Cell[2894, 82, 1203, 29, 31, "Input"],
Cell[4100, 113, 527, 14, 54, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
